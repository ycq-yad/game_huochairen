{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport DYChannelMgr from \"../../../manager/channel/DYChannelMgr\";\r\nimport GameEvent from \"../../../common/GameEvent\";\r\nvar DYMoreGameBanner = (function (_super) {\r\n    tslib_1.__extends(DYMoreGameBanner, _super);\r\n    function DYMoreGameBanner() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"DYMoreGameBanner\";\r\n        _this.itemW = 250;\r\n        _this.autoMove = true;\r\n        _this.nStartX = 0;\r\n        _this.name = \"DYMoreGameBanner\";\r\n        _this.skin = \"skins/channel/duyou/DYMoreGameBanner.json\";\r\n        return _this;\r\n    }\r\n    DYMoreGameBanner.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n    };\r\n    DYMoreGameBanner.prototype.adaptationStage = function () {\r\n    };\r\n    DYMoreGameBanner.prototype.onAddStage = function () {\r\n        if (this.isCreate) {\r\n            this.addEvent();\r\n            this.initView();\r\n        }\r\n    };\r\n    DYMoreGameBanner.prototype.addEvent = function () {\r\n        this.panel_list.on(Laya.Event.MOUSE_DOWN, this, this.onMousedown);\r\n    };\r\n    DYMoreGameBanner.prototype.initView = function () {\r\n        var dataArr = DYChannelMgr.instance.moreGameList;\r\n        this.box_view1.x = 0;\r\n        this.box_view1.removeChildren();\r\n        var len = dataArr.length;\r\n        for (var i = 0; i < len; i++) {\r\n            var item = this.box_view1.getChildAt(i);\r\n            if (item) {\r\n                item.setData(dataArr[i]);\r\n            }\r\n            else {\r\n                item = Laya.Pool.getItemByClass(\"DYMoreGameBannerItem\", DYMoreGameBannerItem);\r\n                item.setData(dataArr[i]);\r\n                item.x = (this.itemW + 20) * i;\r\n                this.box_view1.addChild(item);\r\n            }\r\n        }\r\n        this.box_view1.width = (this.itemW + 20) * len;\r\n        this.box_view2.x = this.box_view1.width;\r\n        this.box_view2.removeChildren();\r\n        for (var i = 0; i < len; i++) {\r\n            var item = this.box_view2.getChildAt(i);\r\n            if (item) {\r\n                item.setData(dataArr[i]);\r\n            }\r\n            else {\r\n                item = Laya.Pool.getItemByClass(\"DYMoreGameBannerItem\", DYMoreGameBannerItem);\r\n                item.setData(dataArr[i]);\r\n                item.x = (this.itemW + 20) * i;\r\n                this.box_view2.addChild(item);\r\n            }\r\n        }\r\n        this.box_view2.width = (this.itemW + 20) * len;\r\n        if (len) {\r\n            this.autoMove = true;\r\n            Laya.timer.frameLoop(1, this, this.onMove);\r\n        }\r\n    };\r\n    DYMoreGameBanner.prototype.onMove = function () {\r\n        if (!this.autoMove)\r\n            return;\r\n        var nWidth = this.box_view1.width;\r\n        this.box_view2.x -= 2;\r\n        this.box_view1.x -= 2;\r\n        if (this.box_view1.x <= -nWidth) {\r\n            this.box_view1.x = this.box_view2.x + nWidth;\r\n        }\r\n        if (this.box_view2.x <= -nWidth) {\r\n            this.box_view2.x = this.box_view1.x + nWidth;\r\n        }\r\n    };\r\n    DYMoreGameBanner.prototype.onMousedown = function (evt) {\r\n        var _this = this;\r\n        this.autoMove = false;\r\n        this.nStartX = evt.currentTarget.mouseX;\r\n        var self = this;\r\n        var mouseMove = function (evt1) {\r\n            var nXTemp = self.nStartX - evt1.currentTarget.mouseX;\r\n            self.box_view1.x -= nXTemp;\r\n            self.box_view2.x -= nXTemp;\r\n            self.nStartX = evt1.currentTarget.mouseX;\r\n            if (self.box_view1.x >= 0 && self.box_view2.x >= 0) {\r\n                self.box_view1.x = 0;\r\n                self.box_view2.x = self.box_view1.width;\r\n            }\r\n        };\r\n        var mouseUp = function (evt1) {\r\n            _this.panel_list.off(Laya.Event.MOUSE_MOVE, _this, mouseMove);\r\n            _this.panel_list.off(Laya.Event.MOUSE_UP, _this, mouseUp);\r\n            _this.panel_list.off(Laya.Event.MOUSE_OUT, _this, mouseUp);\r\n            _this.autoMove = true;\r\n        };\r\n        this.panel_list.on(Laya.Event.MOUSE_MOVE, this, mouseMove);\r\n        this.panel_list.on(Laya.Event.MOUSE_UP, this, mouseUp);\r\n        this.panel_list.on(Laya.Event.MOUSE_OUT, this, mouseUp);\r\n    };\r\n    DYMoreGameBanner.prototype.removeEvent = function () {\r\n        this.panel_list.off(Laya.Event.MOUSE_DOWN, this, this.onMousedown);\r\n    };\r\n    DYMoreGameBanner.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        Laya.timer.clearAll(this);\r\n    };\r\n    return DYMoreGameBanner;\r\n}(BaseSceneUISkin));\r\nexport { DYMoreGameBanner };\r\nvar DYMoreGameBannerItem = (function (_super) {\r\n    tslib_1.__extends(DYMoreGameBannerItem, _super);\r\n    function DYMoreGameBannerItem(data_) {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"DYMoreGameBannerItem\";\r\n        _this.data = data_;\r\n        _this.size(250, 250);\r\n        _this.createUI();\r\n        return _this;\r\n    }\r\n    DYMoreGameBannerItem.prototype.createUI = function () {\r\n        this.img_icon = new Laya.Image();\r\n        this.img_icon.centerX = 0;\r\n        this.img_icon.y = 0;\r\n        this.img_icon.size(250, 250);\r\n        this.addChild(this.img_icon);\r\n    };\r\n    DYMoreGameBannerItem.prototype.setData = function (data_) {\r\n        this.data = data_;\r\n        this.addEvent();\r\n        this.initView();\r\n    };\r\n    DYMoreGameBannerItem.prototype.addEvent = function () {\r\n        this.on(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);\r\n        this.on(Laya.Event.REMOVED, this, this.onRemoved);\r\n    };\r\n    DYMoreGameBannerItem.prototype.initView = function () {\r\n        if (!this.data)\r\n            return;\r\n        var data = this.data;\r\n        this.img_icon.skin = data.ad_img;\r\n    };\r\n    DYMoreGameBannerItem.prototype.onMouseDown = function () {\r\n        var _this = this;\r\n        var startTime = (new Date()).getTime();\r\n        var mouseUp = function (evt) {\r\n            var endTime = (new Date()).getTime();\r\n            if (endTime - startTime <= 150) {\r\n                _this.onPlay();\r\n            }\r\n            _this.off(Laya.Event.MOUSE_UP, _this, mouseUp);\r\n            _this.off(Laya.Event.MOUSE_OUT, _this, mouseOut);\r\n        };\r\n        var mouseOut = function (evt) {\r\n        };\r\n        this.on(Laya.Event.MOUSE_UP, this, mouseUp);\r\n        this.on(Laya.Event.MOUSE_OUT, this, mouseOut);\r\n    };\r\n    DYMoreGameBannerItem.prototype.onPlay = function () {\r\n        if (!this.data)\r\n            return;\r\n        var data = this.data;\r\n        DYChannelMgr.instance.clickGame(data.ad_id);\r\n        var obj = {\r\n            appId: data.ad_appid,\r\n            path: data.url,\r\n            success: function () {\r\n                console.log(\"navigateToMiniProgram success!\");\r\n                DYChannelMgr.instance.toGame(data.ad_id);\r\n            },\r\n            fail: function (e) {\r\n                console.log(\"navigateToMiniProgram fail\", e);\r\n                EventMgr.getInstance().sendEvent(GameEvent.NAV_GAME_FAIL, true);\r\n            }\r\n        };\r\n        wx.navigateToMiniProgram(obj);\r\n    };\r\n    DYMoreGameBannerItem.prototype.removeEvent = function () {\r\n        this.off(Laya.Event.MOUSE_DOWN, this, this.onMouseDown);\r\n        this.off(Laya.Event.REMOVED, this, this.onRemoved);\r\n    };\r\n    DYMoreGameBannerItem.prototype.onRemoved = function () {\r\n        this.removeEvent();\r\n        this.data = null;\r\n        Laya.Pool.recover(\"DYMoreGameBannerItem\", this);\r\n    };\r\n    return DYMoreGameBannerItem;\r\n}(Laya.Box));\r\n",
  "references": [
    "E:/laya/project/laya_firePeople2_git_ts/src/script/manager/channel/DYChannelMgr.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/common/GameEvent.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/manager/GameMgr.ts"
  ]
}
