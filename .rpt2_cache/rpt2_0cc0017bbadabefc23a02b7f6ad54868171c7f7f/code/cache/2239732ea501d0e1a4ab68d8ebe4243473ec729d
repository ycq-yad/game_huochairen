{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport DYChannelMgr from \"../../../manager/channel/DYChannelMgr\";\r\nimport { DYMyGameListItem } from \"./DYMyGameListItem\";\r\nimport GameEvent from \"../../../common/GameEvent\";\r\nvar DYMyGameList = (function (_super) {\r\n    tslib_1.__extends(DYMyGameList, _super);\r\n    function DYMyGameList(data) {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"DYMyGameList\";\r\n        _this.itemH = 200;\r\n        _this.autoMove = true;\r\n        _this.speed = 2;\r\n        _this.dir = -1;\r\n        _this.viewData_ = data;\r\n        _this.name = \"DYMyGameList\";\r\n        _this.skin = \"skins/channel/duyou/DYMyGameList.json\";\r\n        return _this;\r\n    }\r\n    DYMyGameList.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n        this.width = Laya.stage.width;\r\n        this.height = Laya.stage.height;\r\n        this.addEvent();\r\n        this.initView();\r\n    };\r\n    DYMyGameList.prototype.setData = function (data) {\r\n        this.viewData_ = data;\r\n        if (this.isCreate) {\r\n            this.addEvent();\r\n            this.initView();\r\n        }\r\n    };\r\n    DYMyGameList.prototype.addEvent = function () {\r\n        this.panel_list.on(Laya.Event.MOUSE_DOWN, this, this.onMousedown);\r\n        this.btn_back.on(Laya.Event.CLICK, this, this.onBack);\r\n    };\r\n    DYMyGameList.prototype.initView = function () {\r\n        this.viewData_.showFun && this.viewData_.showFun();\r\n        EventMgr.getInstance().sendEvent(GameEvent.HIDE_GAME_DRAWER);\r\n        EventMgr.getInstance().sendEvent(GameEvent.HIDE_EXIT_BTN);\r\n        var canuseHeight = Laya.stage.height - 280 - 20;\r\n        this.panel_list.height = canuseHeight;\r\n        this.maxCount = Math.ceil(canuseHeight / this.itemH);\r\n        this.dataArr = DYChannelMgr.instance.moreGameList;\r\n        console.log(this.dataArr);\r\n        var didnex = 0;\r\n        this.panel_list.removeChildren();\r\n        for (var i = 0; i < this.maxCount + 1; i++) {\r\n            var item = Laya.Pool.getItemByClass(\"DYMyGameListItem\", DYMyGameListItem);\r\n            item.index = didnex;\r\n            item.zOrder = 0;\r\n            item.setData(this.dataArr[item.index]);\r\n            didnex++;\r\n            if (didnex >= this.dataArr.length) {\r\n                didnex = 0;\r\n            }\r\n            item.y = i * this.itemH;\r\n            this.panel_list.addChild(item);\r\n        }\r\n        this.autoMove = true;\r\n        Laya.timer.frameLoop(1, this, this.onMove);\r\n        DYChannelMgr.instance.refreshGameList();\r\n    };\r\n    DYMyGameList.prototype.onMove = function (dt) {\r\n        if (!this.autoMove)\r\n            return;\r\n        for (var i = 0; i < this.panel_list.numChildren; i++) {\r\n            var item = this.panel_list.getChildAt(i);\r\n            item.y += this.speed * this.dir;\r\n        }\r\n        this.refresh();\r\n    };\r\n    DYMyGameList.prototype.refresh = function () {\r\n        var startItem = this.panel_list.getChildAt(0);\r\n        var lastItem = this.panel_list.getChildAt(this.maxCount);\r\n        if (this.dir == -1) {\r\n            if (startItem.y < -this.itemH) {\r\n                startItem.y = lastItem.y + lastItem.height;\r\n                startItem.zOrder = lastItem.zOrder + 1;\r\n                startItem.index = this.getDownIndexforCurIndex(lastItem.index);\r\n                startItem.setData(this.dataArr[startItem.index]);\r\n            }\r\n        }\r\n        else {\r\n            if (lastItem.y > this.maxCount * this.itemH) {\r\n                lastItem.y = startItem.y - startItem.height;\r\n                lastItem.zOrder = startItem.zOrder - 1;\r\n                lastItem.index = this.getUpIndexforCurIndex(startItem.index);\r\n                lastItem.setData(this.dataArr[lastItem.index]);\r\n            }\r\n        }\r\n    };\r\n    DYMyGameList.prototype.getUpIndexforCurIndex = function (index) {\r\n        if (index >= this.dataArr.length || index < 0)\r\n            return 0;\r\n        return index - 1 >= 0 ? index - 1 : this.dataArr.length - 1;\r\n    };\r\n    DYMyGameList.prototype.getDownIndexforCurIndex = function (index) {\r\n        if (index >= this.dataArr.length || index < 0)\r\n            return 0;\r\n        return index + 1 < this.dataArr.length ? index + 1 : 0;\r\n    };\r\n    DYMyGameList.prototype.onMousedown = function (evt) {\r\n        var _this = this;\r\n        this.autoMove = false;\r\n        this.stx = evt.stageX;\r\n        this.sty = evt.stageY;\r\n        var mouseMove = function (evt1) {\r\n            var dy = evt1.stageY - _this.sty;\r\n            for (var i = 0; i < _this.panel_list.numChildren; i++) {\r\n                var item = _this.panel_list.getChildAt(i);\r\n                item.y += dy;\r\n            }\r\n            _this.sty = evt1.stageY;\r\n            _this.dir = dy > 0 ? 1 : -1;\r\n            _this.refresh();\r\n        };\r\n        var mouseUp = function (evt1) {\r\n            _this.panel_list.off(Laya.Event.MOUSE_MOVE, _this, mouseMove);\r\n            _this.panel_list.off(Laya.Event.MOUSE_UP, _this, mouseUp);\r\n            _this.panel_list.off(Laya.Event.MOUSE_OUT, _this, mouseUp);\r\n            _this.dir = -1;\r\n            _this.autoMove = true;\r\n        };\r\n        this.panel_list.on(Laya.Event.MOUSE_MOVE, this, mouseMove);\r\n        this.panel_list.on(Laya.Event.MOUSE_UP, this, mouseUp);\r\n        this.panel_list.on(Laya.Event.MOUSE_OUT, this, mouseUp);\r\n    };\r\n    DYMyGameList.prototype.onBack = function () {\r\n        this.viewData_.backFun && this.viewData_.backFun();\r\n        this.removeSelf();\r\n    };\r\n    DYMyGameList.prototype.removeEvent = function () {\r\n        this.panel_list.off(Laya.Event.MOUSE_DOWN, this, this.onMousedown);\r\n        this.btn_back.off(Laya.Event.CLICK, this, this.onBack);\r\n    };\r\n    DYMyGameList.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        this.viewData_ = null;\r\n        Laya.timer.clearAll(this);\r\n        this.panel_list.removeChildren();\r\n    };\r\n    return DYMyGameList;\r\n}(BaseSceneUISkin));\r\nexport { DYMyGameList };\r\n",
  "references": [
    "E:/laya/project/laya_firePeople2_git_ts/src/script/manager/channel/DYChannelMgr.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/views/channel/duyou/DYMyGameListItem.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/common/GameEvent.ts"
  ]
}
