{
  "code": "import * as tslib_1 from \"tslib\";\r\nimport SoundManager, { SoundConst } from \"../../manager/SoundManager\";\r\nimport { SignScene } from \"./sign/SignScene\";\r\nimport { PowerScene } from \"./power/PowerScene\";\r\nimport GameEvent from \"../../common/GameEvent\";\r\nimport AnimationManager from \"../../manager/AnimationManager\";\r\nimport { GameData } from \"../../common/GameData\";\r\nimport { BrushScene } from \"../games/type2/brush/BrushScene\";\r\nimport { MiniManeger } from \"../../minigame/MiniManeger\";\r\nimport InviteView from \"./invite/InviteView\";\r\nimport GameMgr from \"../../manager/GameMgr\";\r\nvar HomeScene = (function (_super) {\r\n    tslib_1.__extends(HomeScene, _super);\r\n    function HomeScene() {\r\n        var _this = _super.call(this) || this;\r\n        _this.className_key = \"HomeScene\";\r\n        _this.skin = \"skins/uiView/HomeView.json\";\r\n        return _this;\r\n    }\r\n    HomeScene.prototype.childrenCreated = function () {\r\n        _super.prototype.childrenCreated.call(this);\r\n        var res = [\"reward\"];\r\n        if (GameData.getInstance().channel == \"duyou\" && DeviceUtil.isWXMiniGame()) {\r\n            res = [\"channel\", \"reward\"];\r\n        }\r\n        ResUtil.getIntance().loadGroups(res, function () {\r\n            console.log(\"懒加载完成\");\r\n        });\r\n        if (DeviceUtil.isWXMiniGame()) {\r\n            this.img_title.skin = \"resource/assets/imgs/home/main/mianinterface_logo_1_1.png\";\r\n        }\r\n        else {\r\n            this.img_title.skin = \"resource/assets/imgs/home/main/mianinterface_logo_1.png\";\r\n        }\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            this.btn_moreGame.visible = this.btn_invite.visible = this.btn_share.visible = true;\r\n            this.btn_power.centerX = -145;\r\n            this.btn_sign.centerX = 145;\r\n        }\r\n        else {\r\n            this.btn_power.centerX = -157;\r\n            this.btn_sign.centerX = 156;\r\n        }\r\n        if (GameData.getInstance().isConVersion) {\r\n            this.btn_power.visible = this.btn_sign.visible = false;\r\n            this.btn_invite.visible = this.btn_share.visible = false;\r\n        }\r\n        EventMgr.getInstance().sendEvent(GameEvent.SHOW_GAME_DRAWER);\r\n        EventMgr.getInstance().sendEvent(GameEvent.SHOW_EXIT_BTN);\r\n    };\r\n    HomeScene.prototype.onAddStage = function () {\r\n        _super.prototype.onAddStage.call(this);\r\n        if (this.isCreate) {\r\n            this.initView();\r\n            this.addEvent();\r\n        }\r\n    };\r\n    HomeScene.prototype.initView = function () {\r\n        MiniManeger.instance.showBannerAd(null);\r\n        if (GameData.getInstance().channel == \"duyou\" && DeviceUtil.isWXMiniGame()) {\r\n            GameMgr.instance.topBarIsShow = true;\r\n            GameMgr.instance.bannerIsShow = true;\r\n        }\r\n        SoundManager.instance.playBgMusic(SoundConst.GameBgm2);\r\n        EventMgr.getInstance().sendEvent(GameEvent.SHOW_TOP);\r\n        AnimationManager.instance.btnScaleAniLoop(this.btn_start, this);\r\n        this.rollBgUglify();\r\n        this.showAniUglify();\r\n        if (GameMgr.instance.autoShowSign) {\r\n            EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, true);\r\n            ResUtil.getIntance().loadGroups([\"sign\"], function () {\r\n                GameMgr.instance.autoShowSign = false;\r\n                EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, false);\r\n                ViewManager.getInstance().showView(SignScene);\r\n            });\r\n        }\r\n    };\r\n    HomeScene.prototype.addEvent = function () {\r\n        this.btn_power.on(Laya.Event.CLICK, this, this.onPowerUglify);\r\n        this.btn_sign.on(Laya.Event.CLICK, this, this.onSignUglify);\r\n        this.btn_start.on(Laya.Event.CLICK, this, this.onStartUglify);\r\n        this.btn_skin.on(Laya.Event.CLICK, this, this.onSkinUglify);\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            this.btn_moreGame.on(Laya.Event.CLICK, this, this.onMoreGame);\r\n            this.btn_invite.on(Laya.Event.CLICK, this, this.onInvite);\r\n            this.btn_share.on(Laya.Event.CLICK, this, this.onShare);\r\n        }\r\n    };\r\n    HomeScene.prototype.rollBgUglify = function () {\r\n        var _this = this;\r\n        Laya.timer.loop(50, this.box_bg, function () {\r\n            for (var i = 0; i < 3; i++) {\r\n                var img = _this.box_bg.getChildAt(i);\r\n                img.y -= 5;\r\n            }\r\n            var start = _this.box_bg.getChildAt(0);\r\n            var end = _this.box_bg.getChildAt(2);\r\n            if (start.y <= -1920) {\r\n                _this.box_bg.removeChild(start);\r\n                start.y = end.y + 1920;\r\n                _this.box_bg.addChild(start);\r\n            }\r\n        });\r\n    };\r\n    HomeScene.prototype.showAniUglify = function () {\r\n        return tslib_1.__awaiter(this, void 0, void 0, function () {\r\n            var _a;\r\n            return tslib_1.__generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!!this.mainSke) return [3, 2];\r\n                        _a = this;\r\n                        return [4, AnimationManager.instance.creatBoonAnimation(\"resource/assets/db/mianinterface.sk\")];\r\n                    case 1:\r\n                        _a.mainSke = _b.sent();\r\n                        this.box_ani.addChild(this.mainSke);\r\n                        this.mainSke.scale(2, 2);\r\n                        this.mainSke.pos(540, 400);\r\n                        _b.label = 2;\r\n                    case 2:\r\n                        this.mainSke.play(0, true);\r\n                        EventMgr.getInstance().sendEvent(GameEvent.SHOW_GAME_BANNER, this.box_ani);\r\n                        return [2];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    HomeScene.prototype.onPowerUglify = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, true);\r\n        ResUtil.getIntance().loadGroups([\"power\"], function () {\r\n            EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, false);\r\n            ViewManager.getInstance().showView(PowerScene);\r\n        });\r\n    };\r\n    HomeScene.prototype.onSignUglify = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, true);\r\n        ResUtil.getIntance().loadGroups([\"sign\"], function () {\r\n            EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, false);\r\n            ViewManager.getInstance().showView(SignScene);\r\n        });\r\n    };\r\n    HomeScene.prototype.onStartUglify = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        var modelId = GameData.getInstance().modelId;\r\n        var classData;\r\n        switch (modelId) {\r\n            case 0:\r\n                classData = { type: 1 };\r\n                break;\r\n        }\r\n        EventMgr.getInstance().sendEvent(GameEvent.CHOOSE_MODEL, { type: modelId, data: classData });\r\n    };\r\n    HomeScene.prototype.onSkinUglify = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, true);\r\n        ResUtil.getIntance().loadGroups([\"skin2\"], function () {\r\n            EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, false);\r\n            ViewManager.getInstance().showView(BrushScene, { type: 1 });\r\n        });\r\n    };\r\n    HomeScene.prototype.onMoreGame = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        MiniManeger.instance.showAppBoxAd({});\r\n    };\r\n    HomeScene.prototype.onInvite = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, true);\r\n        ResUtil.getIntance().loadGroups([\"invite\"], function () {\r\n            EventMgr.getInstance().sendEvent(GameEvent.BUFFER_LOAD, false);\r\n            ViewManager.getInstance().showView(InviteView);\r\n        });\r\n    };\r\n    HomeScene.prototype.onShare = function () {\r\n        SoundManager.instance.playEffect(SoundConst.BtnClick);\r\n        MiniManeger.instance.shareAppMessage();\r\n    };\r\n    HomeScene.prototype.removeEvent = function () {\r\n        this.btn_power.off(Laya.Event.CLICK, this, this.onPowerUglify);\r\n        this.btn_sign.off(Laya.Event.CLICK, this, this.onSignUglify);\r\n        this.btn_start.off(Laya.Event.CLICK, this, this.onStartUglify);\r\n        this.btn_skin.off(Laya.Event.CLICK, this, this.onSkinUglify);\r\n        if (DeviceUtil.isQQMiniGame()) {\r\n            this.btn_moreGame.off(Laya.Event.CLICK, this, this.onMoreGame);\r\n            this.btn_invite.off(Laya.Event.CLICK, this, this.onInvite);\r\n            this.btn_share.off(Laya.Event.CLICK, this, this.onShare);\r\n        }\r\n    };\r\n    HomeScene.prototype.onRemoved = function () {\r\n        _super.prototype.onRemoved.call(this);\r\n        this.removeEvent();\r\n        Laya.Tween.clearAll(this.btn_start);\r\n        Laya.timer.clearAll(this.box_bg);\r\n        this.mainSke && this.mainSke.stop();\r\n        EventMgr.getInstance().sendEvent(GameEvent.HIDE_GAME_BANNER, this.box_ani);\r\n    };\r\n    return HomeScene;\r\n}(BaseSceneUISkin));\r\nexport { HomeScene };\r\n",
  "references": [
    "E:/laya/project/laya_firePeople2_git_ts/src/script/manager/SoundManager.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/views/uiView/sign/SignScene.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/views/uiView/power/PowerScene.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/common/GameEvent.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/manager/AnimationManager.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/common/GameData.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/tool/TextFlow.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/tool/MathUtil.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/views/games/type2/brush/BrushScene.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/minigame/MiniManeger.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/views/uiView/invite/InviteView.ts",
    "E:/laya/project/laya_firePeople2_git_ts/src/script/manager/GameMgr.ts"
  ]
}
